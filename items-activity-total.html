<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Items Activity Total - SONIC POS</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="sonic logo.png">
    <meta name="theme-color" content="#667eea">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <img src="sonic logo.png" alt="SONIC Logo" class="logo">
                    <h1>Items Activity Total</h1>
                </div>
                <div class="user-controls">
                    <span id="current-user" class="user-info">Welcome, User</span>
                    <button onclick="logout()" class="btn btn-secondary">Logout</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <a href="home.html" class="nav-tab">Home</a>
            <a href="sale.html" class="nav-tab">POS</a>
            <a href="return-sale.html" class="nav-tab">Return Sale</a>
            <a href="transfer.html" class="nav-tab">Transfer</a>
            <a href="items.html" class="nav-tab">Items</a>
            <a href="customers.html" class="nav-tab">Customers</a>
            <a href="dashboard.html" class="nav-tab">Dashboard</a>
            <a href="items-activity.html" class="nav-tab">Item Activity</a>
            <a href="items-inventory.html" class="nav-tab">Inventory</a>
            <a href="items-activity-total.html" class="nav-tab active">Activity Total</a>
            <a href="debt-management.html" class="nav-tab">Debt Management</a>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Loading Indicator -->
            <div id="loading-indicator" style="text-align: center; padding: 40px; display: none;">
                <div style="font-size: 18px; color: #666;">Loading Activity Data...</div>
            </div>
            
            <!-- Error Message -->
            <div id="error-message" style="display: none; background: #fee2e2; color: #991b1b; padding: 15px; border-radius: 8px; margin: 20px 0; text-align: center;">
                <strong>Error:</strong> <span id="error-text"></span>
            </div>

            <!-- Filter Section -->
            <div class="filter-section">
                <div class="filter-group">
                    <label for="date-range">
                        <span style="background: #059669; color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; text-transform: uppercase; margin-right: 6px;">Date:</span>
                        Date Range
                    </label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="position: relative; display: inline-block;">
                            <i class="fas fa-calendar-alt" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #6b7280; pointer-events: none; z-index: 2;"></i>
                            <input type="date" id="start-date" onchange="updateActivityTotal()" style="padding: 8px 8px 8px 35px; border: 1px solid #ddd; border-radius: 4px; width: 150px;">
                        </div>
                        <span style="color: #6b7280; font-weight: 500;">to</span>
                        <div style="position: relative; display: inline-block;">
                            <i class="fas fa-calendar-alt" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #6b7280; pointer-events: none; z-index: 2;"></i>
                            <input type="date" id="end-date" onchange="updateActivityTotal()" style="padding: 8px 8px 8px 35px; border: 1px solid #ddd; border-radius: 4px; width: 150px;">
                        </div>
                        <button onclick="setDateRange('today')" class="btn btn-secondary" style="padding: 8px 12px; font-size: 12px;">Today</button>
                        <button onclick="setDateRange('week')" class="btn btn-secondary" style="padding: 8px 12px; font-size: 12px;">This Week</button>
                        <button onclick="setDateRange('month')" class="btn btn-secondary" style="padding: 8px 12px; font-size: 12px;">This Month</button>
                    </div>
                </div>
                <div class="filter-group">
                    <label for="item-filter-input">
                        <span style="background: #6b7280; color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; text-transform: uppercase; margin-right: 6px;">Item:</span>
                        Search Item Name
                    </label>
                    <div style="position: relative; display: inline-block;">
                        <i class="fas fa-box" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #6b7280; pointer-events: none; z-index: 2;"></i>
                        <input type="text" id="item-filter-input" placeholder="Enter item name..." oninput="handleItemSearchTotal()" onfocus="showItemSuggestionsTotal()" onblur="hideItemSuggestionsTotal()" style="padding: 8px 8px 8px 35px; border: 1px solid #ddd; border-radius: 4px; width: 200px;">
                        <div id="item-suggestions-total" style="position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 200px; overflow-y: auto; z-index: 1000; display: none; margin-top: 2px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <!-- Item suggestions will appear here -->
                        </div>
                    </div>
                    <select id="item-filter" onchange="updateActivityTotal()" style="display: none;">
                        <option value="all">All Items</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="customer-filter-total">
                        <span style="background: #4f46e5; color: white; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600; text-transform: uppercase; margin-right: 6px;">Customer:</span>
                        Search Customer Name
                    </label>
                    <div style="position: relative; display: inline-block;">
                        <i class="fas fa-search" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #6b7280; pointer-events: none; z-index: 2;"></i>
                        <input type="text" id="customer-filter-total" placeholder="Enter customer name..." oninput="handleCustomerSearchTotal()" onfocus="showCustomerSuggestionsTotal()" onblur="hideCustomerSuggestionsTotal()" style="padding: 8px 8px 8px 35px; border: 1px solid #ddd; border-radius: 4px; width: 200px;">
                        <div id="customer-suggestions-total" style="position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 200px; overflow-y: auto; z-index: 1000; display: none; margin-top: 2px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <!-- Customer suggestions will appear here -->
                        </div>
                    </div>
                </div>
                <button onclick="exportActivityTotal()" class="btn btn-primary">Export Report</button>
            </div>

            <!-- Summary Cards -->
            <div class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Sales</h3>
                        <div class="stat-value" id="total-sales">$0.00</div>
                        <div class="card-change" id="sales-change">+0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Returns</h3>
                        <div class="stat-value" id="total-returns">$0.00</div>
                        <div class="card-change" id="returns-change">+0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>Items Sold</h3>
                        <div class="stat-value" id="items-sold">0</div>
                        <div class="card-change" id="items-sold-change">+0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Profit</h3>
                        <div class="stat-value" id="total-profit">$0.00</div>
                        <div class="card-change" id="profit-change">+0%</div>
                    </div>
                </div>
            </div>

            <!-- Activity Summary Table -->
            <div class="table-section">
                <h2>Activity Summary</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Total Sold</th>
                                <th>Total Revenue</th>
                                <th>Total Returns</th>
                                <th>Net Sales</th>
                                <th>Profit Margin</th>
                                <th>Activity Score</th>
                            </tr>
                        </thead>
                        <tbody id="activity-summary-tbody">
                            <!-- Activity data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Top Performers -->
            <div class="table-section">
                <h2>Top Performing Items</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Item Name</th>
                                <th>Sales Count</th>
                                <th>Revenue</th>
                                <th>Profit</th>
                                <th>Performance</th>
                            </tr>
                        </thead>
                        <tbody id="top-performers-tbody">
                            <!-- Top performers data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Simple error handling and debugging
        window.addEventListener('error', function(e) {
            console.error('JavaScript Error:', e.error);
            const errorDiv = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            if (errorDiv && errorText) {
                errorText.textContent = e.error.message || 'Unknown error occurred';
                errorDiv.style.display = 'block';
            }
        });
        
        // Show loading indicator
        document.addEventListener('DOMContentLoaded', function() {
            const loading = document.getElementById('loading-indicator');
            if (loading) {
                loading.style.display = 'block';
            }
        });
    </script>
    
    <script src="shared.js"></script>
    <script src="items-activity-total.js"></script>
    
    <script>
        // Hide loading indicator after scripts load
        window.addEventListener('load', function() {
            const loading = document.getElementById('loading-indicator');
            if (loading) {
                loading.style.display = 'none';
            }
        });
    </script>
</body>
</html>
